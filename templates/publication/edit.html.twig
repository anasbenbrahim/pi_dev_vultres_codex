{% extends 'baseclient.html.twig' %}

{% block title %}Modifier la publication{% endblock %}

{% block body %}

<style>
    .container {
        width: 40%;
    }

    .error {
        color: red;
        font-size: 12px;
        margin-top: 5px;
    }
</style>

<div class="container card mt-3 mb-3 shadow">
    <div class="card-header">
        <h1 class="text-center">Modifier la publication</h1>
    </div>

    <div class="card-body">
        {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}

        <div class="form-group">
            {{ form_label(form.titre) }}
            {{ form_widget(form.titre, {'attr': {'class': 'form-control'}}) }}
            <div class="error">{{ form_errors(form.titre) }}</div>
        </div>

        <div class="form-group">
            {{ form_label(form.description) }}
            {{ form_widget(form.description, {'attr': {'class': 'form-control'}}) }}
            <div class="error">{{ form_errors(form.description) }}</div>
        </div>

        <div class="form-group">
            {{ form_label(form.date) }}
            {{ form_widget(form.date, {'attr': {'class': 'form-control', 'readonly': 'readonly'}}) }}
            <div class="error">{{ form_errors(form.date) }}</div>
        </div>

        <div class="form-group">
            <label class="small-label">{{ form_label(form.imageChoice) }}</label>
            {{ form_widget(form.imageChoice, {'attr': {'class': 'form-control'}}) }}
            <div class="error">{{ form_errors(form.imageChoice) }}</div>
        </div>

        <!-- File Upload Section -->
        <div id="fileUpload" class="form-group" style="display: none;">
            <label class="small-label">{{ form_label(form.imageFile) }}</label>
            {{ form_widget(form.imageFile, {'attr': {'class': 'form-control'}}) }}
            <div class="error">{{ form_errors(form.imageFile) }}</div>
        </div>

        <!-- URL Input Section -->
        <div id="urlInput" class="form-group" style="display: none;">
            <label class="small-label">{{ form_label(form.image) }}</label>
            {{ form_widget(form.image, {'attr': {'class': 'form-control'}}) }}
            <div class="error">{{ form_errors(form.image) }}</div>
        </div>

        <button type="submit" class="btn btn-warning text-light form-control">Enregistrer</button>

        {{ form_end(form) }}
    </div>
</div>

<script>
    // JavaScript to toggle between file upload and URL input
    const fileUploadSection = document.getElementById('fileUpload');
    const urlInputSection = document.getElementById('urlInput');
    const imageChoiceRadioButtons = document.querySelectorAll('input[name="publication[imageChoice]"]');
    
    // Set the initial visibility based on the current selection
    function updateVisibility() {
        const selectedValue = document.querySelector('input[name="publication[imageChoice]"]:checked');
        if (selectedValue && selectedValue.value === 'upload') {
            fileUploadSection.style.display = 'block';
            urlInputSection.style.display = 'none';
        } else if (selectedValue && selectedValue.value === 'url') {
            fileUploadSection.style.display = 'none';
            urlInputSection.style.display = 'block';
        }
    }
    
    imageChoiceRadioButtons.forEach(radio => {
        radio.addEventListener('change', updateVisibility);
    });
    
    // Call updateVisibility initially to set the correct state
    updateVisibility();
</script>

{% endblock %}
